DEBUG 2026-01-16 21:31:33,540 functional 
def accumulate(self, *args, **kwargs):
    return 1

DEBUG 2026-01-16 21:31:33,541 functional 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

DEBUG 2026-01-16 21:31:33,541 functional 
def execute_backtest_task(backtest_run_id, stock_ids, execution_mode=0):
    return 1

DEBUG 2026-01-16 21:31:33,541 functional 
def chunks(task, it, n):
    return 1

DEBUG 2026-01-16 21:31:33,541 functional 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

DEBUG 2026-01-16 21:31:33,542 functional 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

DEBUG 2026-01-16 21:31:33,542 functional 
def xmap(task, it):
    return 1

DEBUG 2026-01-16 21:31:33,542 functional 
def debug_task(self):
    return 1

DEBUG 2026-01-16 21:31:33,542 functional 
def backend_cleanup():
    return 1

DEBUG 2026-01-16 21:31:33,542 functional 
def auto_sync_daily():
    return 1

DEBUG 2026-01-16 21:31:33,542 functional 
def sync_stocks_task(is_auto=0, user_id=1, from_date=2, to_date=3, instruments=4, sync_indices=5):
    return 1

DEBUG 2026-01-16 21:31:33,543 functional 
def delete_old_notifications():
    return 1

DEBUG 2026-01-16 21:31:33,543 functional 
def sync_hard_task(sync_type, start_date, end_date, instruments=0, user_id=1):
    return 1

DEBUG 2026-01-16 21:31:33,543 functional 
def chain(*args, **kwargs):
    return 1

DEBUG 2026-01-16 21:31:33,543 functional 
def xstarmap(task, it):
    return 1

[2026-01-16 21:31:33,633: WARNING/MainProcess] 
Setting ssl_cert_reqs=CERT_NONE when connecting to redis means that celery will not validate the identity of the redis broker when connecting. This leaves you vulnerable to man in the middle attacks.

SETTINGS-DEBUG: Looking for .env at: /Users/chat360team/Documents/papertrade/papertrade-backend/.env
SETTINGS-DEBUG: .env exists: True
SETTINGS-DEBUG: Loaded .env successfully
 
 -------------- celery@Chat360s-Air.lan v5.3.4 (emerald-rush)
--- ***** ----- 
-- ******* ---- macOS-13.2.1-arm64-arm-64bit-Mach-O 2026-01-16 21:31:33
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         papertrade:0x1034082f0
- ** ---------- .> transport:   rediss://default:**@pumped-turkey-23712.upstash.io:6379//
- ** ---------- .> results:     rediss://default:**@pumped-turkey-23712.upstash.io:6379/
- *** --- * --- .> concurrency: 8 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . apps.backtests.tasks.execute_backtest_task
  . apps.notifications.tasks.delete_old_notifications
  . apps.sync.tasks.auto_sync_daily
  . apps.sync.tasks.sync_hard_task
  . apps.sync.tasks.sync_stocks_task
  . config.celery.debug_task

[2026-01-16 21:31:34,151: WARNING/MainProcess] /Users/chat360team/Documents/papertrade/papertrade-backend/venv/lib/python3.13/site-packages/celery/worker/consumer/consumer.py:507: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2026-01-16 21:31:34,840: ERROR/MainProcess] consumer: Cannot connect to rediss://default:**@pumped-turkey-23712.upstash.io:6379//: max requests limit exceeded. Limit: 500000, Usage: 500000. See https://upstash.com/docs/redis/troubleshooting/max_requests_limit for details.
Trying again in 2.00 seconds... (1/100)

[2026-01-16 21:31:37,434: ERROR/MainProcess] consumer: Cannot connect to rediss://default:**@pumped-turkey-23712.upstash.io:6379//: max requests limit exceeded. Limit: 500000, Usage: 500000. See https://upstash.com/docs/redis/troubleshooting/max_requests_limit for details.
Trying again in 4.00 seconds... (2/100)

[2026-01-16 21:31:44,209: CRITICAL/MainProcess] Unrecoverable error: ResponseError('max requests limit exceeded. Limit: 500000, Usage: 500000. See https://upstash.com/docs/redis/troubleshooting/max_requests_limit for details')
Traceback (most recent call last):
  File "/Users/chat360team/Documents/papertrade/papertrade-backend/venv/lib/python3.13/site-packages/celery/worker/worker.py", line 202, in start
    self.blueprint.start(self)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/chat360team/Documents/papertrade/papertrade-backend/venv/lib/python3.13/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
    ~~~~~~~~~~^^^^^^^^
  File "/Users/chat360team/Documents/papertrade/papertrade-backend/venv/lib/python3.13/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
           ~~~~~~~~~~~~~~^^
  File "/Users/chat360team/Documents/papertrade/papertrade-backend/venv/lib/python3.13/site-packages/celery/worker/consumer/consumer.py", line 340, in start
    blueprint.start(self)
    ~~~~~~~~~~~~~~~^^^^^^
  File "/Users/chat360team/Documents/papertrade/papertrade-backend/venv/lib/python3.13/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
    ~~~~~~~~~~^^^^^^^^
  File "/Users/chat360team/Documents/papertrade/papertrade-backend/venv/lib/python3.13/site-packages/celery/worker/consumer/connection.py", line 21, in start
    c.connection = c.connect()
                   ~~~~~~~~~^^
  File "/Users/chat360team/Documents/papertrade/papertrade-backend/venv/lib/python3.13/site-packages/celery/worker/consumer/consumer.py", line 471, in connect
    conn.transport.register_with_event_loop(conn.connection, self.hub)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chat360team/Documents/papertrade/papertrade-backend/venv/lib/python3.13/site-packages/kombu/transport/redis.py", line 1361, in register_with_event_loop
    cycle.on_poll_init(loop.poller)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/chat360team/Documents/papertrade/papertrade-backend/venv/lib/python3.13/site-packages/kombu/transport/redis.py", line 556, in on_poll_init
    return channel.qos.restore_visible(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        num=channel.unacked_restore_limit,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/chat360team/Documents/papertrade/papertrade-backend/venv/lib/python3.13/site-packages/kombu/transport/redis.py", line 417, in restore_visible
    with Mutex(client, self.unacked_mutex_key,
         ~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
               self.unacked_mutex_expire):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/chat360team/Documents/papertrade/papertrade-backend/venv/lib/python3.13/site-packages/kombu/transport/redis.py", line 173, in Mutex
    lock_acquired = lock.acquire(blocking=False)
  File "/Users/chat360team/Documents/papertrade/papertrade-backend/venv/lib/python3.13/site-packages/redis/lock.py", line 207, in acquire
    if self.do_acquire(token):
       ~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/chat360team/Documents/papertrade/papertrade-backend/venv/lib/python3.13/site-packages/redis/lock.py", line 223, in do_acquire
    if self.redis.set(self.name, token, nx=True, px=timeout):
       ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chat360team/Documents/papertrade/papertrade-backend/venv/lib/python3.13/site-packages/redis/commands/core.py", line 2341, in set
    return self.execute_command("SET", *pieces, **options)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chat360team/Documents/papertrade/papertrade-backend/venv/lib/python3.13/site-packages/redis/client.py", line 536, in execute_command
    return conn.retry.call_with_retry(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        lambda: self._send_command_parse_response(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        lambda error: self._disconnect_raise(conn, error),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/chat360team/Documents/papertrade/papertrade-backend/venv/lib/python3.13/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/chat360team/Documents/papertrade/papertrade-backend/venv/lib/python3.13/site-packages/redis/client.py", line 537, in <lambda>
    lambda: self._send_command_parse_response(
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        conn, command_name, *args, **options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ),
    ^
  File "/Users/chat360team/Documents/papertrade/papertrade-backend/venv/lib/python3.13/site-packages/redis/client.py", line 513, in _send_command_parse_response
    return self.parse_response(conn, command_name, **options)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chat360team/Documents/papertrade/papertrade-backend/venv/lib/python3.13/site-packages/redis/client.py", line 553, in parse_response
    response = connection.read_response()
  File "/Users/chat360team/Documents/papertrade/papertrade-backend/venv/lib/python3.13/site-packages/redis/connection.py", line 524, in read_response
    raise response
redis.exceptions.ResponseError: max requests limit exceeded. Limit: 500000, Usage: 500000. See https://upstash.com/docs/redis/troubleshooting/max_requests_limit for details
